<div class="background-search" style="
    background-image: url('./assets/media/images/struktur_bg.jpeg');
    background-repeat: no-repeat;
    background-position: center;
    height: 185px;
    fill:solid rgb(0,0,0)
"></div>
<div class="card card-custom gutter-b mx-15 mt-n50" style="overflow-x: hidden;">
    <div class="card-body d-flex flex-column flex-grow flex-wrap">
        <div>Struktur Menu</div>
        <div>Menu untuk menambahkan, mengubah, atau menghapus struktur level PAKAR.</div>
        <div class="struktur-container d-flex flex-row flex-column-fluid rounded-sm">
            <div class="section-nav d-flex flex-column flex-row-auto">
                <div class="nav-header d-flex flex-row justify-content-between">
                    <a routerLink="/homepage">
                        PAKAR<br>
                        PANDUAN KERJA DIGITAL
                    </a>
                    <a (click)="open(formAddSection)" class="btn btn-xs btn-light-success btn-icon"><i
                            class="fas fa-plus-circle"></i></a>
                </div>
                <ul class="navi navi-hover">
                    <ng-container *ngFor="let item of menuConfig.items">
                        <ng-container class="navi-item" *ngIf="item.root === true" [ngTemplateOutlet]="rowItem"
                            [ngTemplateOutletContext]="{item:item}">
                        </ng-container>
                    </ng-container>
                </ul>
            </div>
            <div class="section-body d-flex flex-column flex-row-fluid pt-5">
                <app-struktur-lvl2-tree [selected]="selected$"></app-struktur-lvl2-tree>
            </div>
        </div>
    </div>
</div>

<ng-template #rowItem let-item="item">
    <li class="navi-item" [ngClass]="{'cursor-pointer': item.id, 'disabled': !item.id}" (click)="setJsTree(item)">
        <a class="navi-link" [ngClass]="{disabled: !item.id}">
            <span class="navi-text">{{item.title}}</span>
            <span class="navi-arrow" *ngIf="item.id"></span>
        </a>
    </li>
</ng-template>

<ng-template #rowEmpty>
    <span>Data Menu Kosong</span>
</ng-template>

<ng-template #formAddSection let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Tambah Menu</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <i aria-hidden="true">&times;</i>
        </button>
    </div>
    <div class="modal-body">
        <form class="form" [formGroup]="dataForm" novalidate="novalidate" (ngSubmit)="save()">
            <div class="form-group">
                <label>Nama Menu *</label>
                <input class="form-control" type="text" maxlength="50" placeholder="Masukkan nama menu" required
                    formControlName="name" autocomplete="off" [ngClass]="{ 'is-invalid': hasError}">
                <ng-container [ngTemplateOutlet]="formError"
                    [ngTemplateOutletContext]="{ control: dataForm.controls['name']}"></ng-container>
            </div>
            <div class="form-group">
                <label>Icon Menu *</label>
                <input class="form-control" type="file" placeholder="Pilih Gambar" required formControlName="icon"
                    autocomplete="off" [ngClass]="{ 'is-invalid': hasError }"
                    onchange="console.log(event.target.files)">
                <small>Icon diperlukan untuk kebutuhan navigasi menu kiri.</small>
                <ng-container [ngTemplateOutlet]="formError"
                    [ngTemplateOutletContext]="{ control: dataForm.controls['icon']}"></ng-container>
            </div>
            <div class="form-group">
                <label>Gambar Menu *</label>
                <input class="form-control" type="file" placeholder="Pilih Gambar" required formControlName="image"
                    autocomplete="off" [ngClass]="{ 'is-invalid': hasError}">
                <small>Gambar diperlukan untuk kebutuhan homepage.</small>
                <ng-container [ngTemplateOutlet]="formError"
                    [ngTemplateOutletContext]="{ control: dataForm.controls['image']}"></ng-container>
            </div>
            <div class="form-group">
                <label>Deskripsi Menu *</label>
                <textarea class="form-control" maxlength="200" placeholder="Masukkan definisi dari Kategori terkait"
                    required formControlName="desc" autocomplete="off"
                    [ngClass]="{ 'is-invalid': hasError }"></textarea>
                <ng-container [ngTemplateOutlet]="formError"
                    [ngTemplateOutletContext]="{ control: dataForm.controls['desc']}"></ng-container>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-light btn-sm rounded-lg" (click)="c('Batal')">Batal</button>
        <button type="button" class="btn btn-outline-dark btn-sm rounded-lg" (click)="save()"
            [disabled]="dataForm.invalid">Tambah</button>
    </div>
</ng-template>

<ng-template #formError let-control="control">
    <ng-container *ngIf="control.errors && control.dirty">
        <div class="fv-plugins-message-container">
            <div class="fv-help-block">
                <ng-container *ngIf="control.errors.required"><span>Field harus disi</span></ng-container>
                <ng-container *ngIf="control.errors.minlength"><span>Panjang minimal
                        {{control.errors.minlength.requiredLength}}</span></ng-container>
                <ng-container *ngIf="control.errors.maxlength"><span>Panjang maximal
                        {{control.errors.maxlength.requiredLength}}</span></ng-container>
            </div>
        </div>
    </ng-container>
</ng-template>