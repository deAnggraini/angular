<div class="top-bar">
    Batal - Komentar - Preview - Simpan - Simpan & Kirim
</div>
<div *ngIf="!finishRender" class="pakar-container mx-15 p-8" style="padding-top:calc(2rem + 50px) !important">
    TUNGGU CKEDITOR SELESAI
</div>
<div *ngIf="finishRender" class="pakar-container mx-15 p-8" style="padding-top:calc(2rem + 50px) !important">
    <span class="pakar-text-header">Tambah Artikel</span>
    <form>
        <div class="form-group">
            <label>Judul Artikel *</label>
            <input class="form-control">
        </div>
        <div class="form-group">
            <label>Lokasi Artikel *</label>
            <select class="form-control">
                <option value="0">-- Silahkan Pilih --</option>
            </select>
        </div>
        <div class="form-group">
            <label>Deskripsi Singkat *</label>
            <ckeditor #editorDesc [editor]="editor" [config]="config" tagName="textarea" (ready)="onReady($event)"
                (change)="onChange($event)"></ckeditor>
        </div>
        <div class="form-group">
            <label>Gambar Artikel *</label>
            <input type="file" class="form-control">
        </div>
        <div class="form-group">
            <label>Video Artikel *</label>
            <input type="url" class="form-control">
        </div>
        <div class="form-group">
            <label>Content Artikel *</label>
            <div class="border border-light rounded-sm p-3">
                <mat-accordion [togglePosition]="'before'" multi="true">
                    <mat-expansion-panel *ngFor="let content of formData.contents;" class="acc-level acc-level-1">
                        <mat-expansion-panel-header [@.disabled]="true">
                            <div>
                                <span>{{content.title}}</span>
                                <span [inlineSVG]="'./assets/media/svg/bca/icon/info.svg'" cacheSVG="true"
                                    class="svg-icon svg-icon-sm" placement="right"
                                    ngbTooltip="Berisi aturan/kaidah/ketetapan/syarat/kriteria atas produk/aplikasi yang harus dipahami pembaca sebelum melakukan prosedur atas produk/aplikasi tersebut; dapat dituangkan dalam bentuk kalimat ataupun tabel."></span>
                            </div>
                        </mat-expansion-panel-header>
                        <div cdkDropListGroup>
                            <input type="text" class="txt-desc-lvl1"
                                placeholder="Masukkan kalimat pengantar terkait {{content.title}} disini.">
                            <div class="input-accordion-separator"></div>
                            <ng-container *ngIf="content.children.length" [ngTemplateOutlet]="accordionChild"
                                [ngTemplateOutletContext]="{ children: content.children, level:2}">
                            </ng-container>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </div>
        </div>

        <div class="form-group">
            <label>SK/SE Referensi <span class="text-danger">*</span></label>
            <pakar-multi-select [(ngModel)]="formData.references" [ngModelOptions]="{standalone: true}"
                placeholder="Masukkan Nomor Referensi atau Judul SKSE dari Artikel ini" [dataList]="skReferences"
                (getData)="getDataSkSeReference($event)">
            </pakar-multi-select>
        </div>
        <div class="form-group">
            <label>Artikel Terkait <span class="text-danger">*</span></label>
            <pakar-multi-select [(ngModel)]="formData.references" [ngModelOptions]="{standalone: true}"
                placeholder="Masukkan Nomor Referensi atau Judul SKSE dari Artikel ini"
                (getData)="getDataSkSeReference($event)">
            </pakar-multi-select>
        </div>
        <div class="form-group">
            Suggestion :
            <pakar-multi-select [(ngModel)]="formData.references" [ngModelOptions]="{standalone: true}"
                placeholder="Masukkan Nomor Referensi atau Judul SKSE dari Artikel ini"
                (getData)="getDataSkSeReference($event)">
            </pakar-multi-select>
        </div>
    </form>
</div>

<ng-template #rightIcon let-data="data">
    <div>
        <span [inlineSVG]="'./assets/media/svg/bca/icon/plus.svg'" cacheSVG="true"
            class="svg-icon svg-icon-sm mr-2"></span>
        <span [inlineSVG]="'./assets/media/svg/bca/icon/pencil.svg'" cacheSVG="true"
            class="svg-icon svg-icon-sm mr-2"></span>
        <span [inlineSVG]="'./assets/media/svg/bca/icon/trash-bin.svg'" cacheSVG="true"
            class="svg-icon svg-icon-sm mr-2"></span>
    </div>
</ng-template>

<ng-template #accordionChild let-children="children" let-level="level">
    <mat-accordion cdkDropList (cdkDropListDropped)="drop($event)" [cdkDropListData]="children"
        [togglePosition]="'before'" hideToggle="false" multi="true">
        <mat-expansion-panel [@.disabled]="true" *ngFor="let content of children; let i = index" cdkDrag
            [cdkDragData]="content" class="acc-level acc-level-{{level}}">
            <div class="drag-placeholder" *cdkDragPlaceholder></div>
            <mat-expansion-panel-header>
                <mat-panel-title>{{content.title}}</mat-panel-title>
                <ng-container [ngTemplateOutlet]="rightIcon"></ng-container>
            </mat-expansion-panel-header>
            <div class="content p-3">
                <div class="form-group">
                    <label>Judul Topik *</label>
                    <input type="text" class="form-control">
                </div>
                <div class="form-group">
                    <label>Isi Topik *</label>
                    <ckeditor [editor]="editor" [config]="config" tagName="textarea"></ckeditor>
                </div>
                <div class="text-right">
                    <button type="button" class="btn btn-outline-light btn-sm rounded-lg px-5">Batal</button>
                    <button type="button" class="btn btn-sm btn-blue rounded-lg px-5">Simpan</button>
                </div>
                <ng-container *ngIf="content.children.length" [ngTemplateOutlet]="accordionChild"
                    [ngTemplateOutletContext]="{ children: content.children, level : level+1}">
                </ng-container>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
</ng-template>